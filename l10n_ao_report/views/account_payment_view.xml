<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>

        <record id="l10n_ao_report_account_payment_view_form" model="ir.ui.view">
            <field name="name">l10n_ao_report: Payment View form Inherit</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">
                <group>
                    <!--readonly="1"
                                       invisible="1" save_force="1"-->
                    <field name="cash_flow_in_payment" invisible="1"/>
                    <field name="account_payment_report_line_ids"
                           attrs="{'invisible': [('cash_flow_in_payment','=', False)],'readonly': [('state','!=', 'draft')]}">
                        <tree name="Fluxo de Caixa" editable="bottom">
                            <!--                            <field name="account_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="cash_flow_statement_id" options="{'no_create': True, 'no_open': True}"/>
                            <field name="cash_flow_statement_line_id" options="{'no_create': True, 'no_open': True}"
                                   domain="[('cash_flow_statement_id', '=', cash_flow_statement_id)]"/>
                            <field name="amount"/>
                        </tree>
                    </field>
                </group>
            </field>
        </record>

        <record id="view_account_payment_form_inherit" model="ir.ui.view">
            <field name="name">account.payment.form.inherit.register_cashflow</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">
                <!-- Adicionando o campo register_cashflow apÃ³s o campo partner_bank_id -->
                <xpath expr="//field[@name='partner_bank_id']" position="after">
                    <field name="register_cashflow"/>
                    <field name="line_cashflow" invisible="1"/>
                    <field name="register_cashflow_computed" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='account_payment_report_line_ids']" position="replace">
                    <field name="account_payment_report_line_ids"
                           attrs="{'invisible': ['|',('cash_flow_in_payment','=', False), ('register_cashflow', '=', False)],'readonly': [('state','!=', 'draft')]}">
                        <form name="Fluxo de Caixa">
                            <group>
                                <field name="cash_flow_statement_id" string="Rubrica de Fluxo de Caixa"/>
                                <field name="line_cashflow" string="Linha de Fluxo"/>
                                <field name="cash_flow_statement_line_id"
                                       options="{'no_create': True, 'no_open': True}"
                                       domain="[('cash_flow_statement_id', '=', cash_flow_statement_id)]"
                                       required="0" attrs="{'invisible': [('line_cashflow', '=', False)]}"
                                       string="Linha de Fluxo"
                                />
                                <field name="amount" string="Valor"/>
                            </group>
                        </form>
                    </field>
                </xpath>
            </field>
        </record>
    </data>
</odoo>